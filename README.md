## products-manager
### Проект предназначен для обработки поступлений товаров. 

Технологии:
- Java
- Spring Boot
- PostgreSQL
- Docker
- Maven

Объектная модель:
- Deal - договор о поставке, в рамках которого может быть передано несколько видов продуктов.
- Product - продукт, содержит название продукта и текущую цену (цена обновляется по запросу, история цен хранится в таблице).
- Supply - поступление продукта. То есть один договор (Deal) может содержать несколько разных поступление (Supply).
При этом в каждом поступлении (Supply) хранится информация об одном продукте (Product) и цене, за которую этот продукт был куплен.
- Seller - поставщик
- Customer - покупатель

Подобная модель позволяет в рамках одного договора провести поступление разных видов продуктов и учесть текущую цену. 
Даже если цена в будущем изменится, то при формировании отчета будет видно за какую реальную цену продукт был куплен.
Актуальную цену также можно посмотреть.

Эндпоинты:
- POST/deal-management - Обработка договора о поставке, проведение поступлений товаров

Пример тела запроса: 
```json
{
  "sellerId": "4a45da41-a4c3-49a1-9c81-bb0381ef0c57",
  "customerId": "4027f597-66c9-4eb1-a600-c24cb4f9b963",
  "name": "Хорошая сделка",
  "supplies": [
    {
      "productId": "02d4e764-340c-4822-87bb-5d8be1a80d2e",
      "weight": 10
    },
    {
      "productId": "c8e2b639-f610-4fab-8cb4-ec3c2bdc346d",
      "weight": 20
    }
  ]
}
```

Пример тела ответа:
```json
{
  "name": "Хорошая сделка",
  "description": "Поступление товаров обработано",
  "date": "23-03-2025"
}
```

- POST/product-management - Обновление цены на продукт, сохранение предыдущей цены в историю

Пример тела запроса:
```json
{
  "productId": "9438fdb0-b89b-4e91-8f03-901b6923044b",
  "newPrice": 888
}
```

Пример тела ответа:
```json
{
  "priceArchived": 888,
  "startDate": "2025-03-23 09:56:18"
}
```

- POST/supply-management/report - Получение отчета о поступлениях в зависимости от пришедших полей

Пример тела запроса:
```json
{
  "sellerId": "4a45da41-a4c3-49a1-9c81-bb0381ef0c57"
}
```
Помимо sellerId, также можно указать productId, customerId, fromDate и toDate (сразу оба поля) для фильтрации.

Пример тела ответа:
```json
{
  "date": "23-03-2025",
  "countWeight": 30,
  "countCost": 1700,
  "supplies": [
    {
      "name": "Лимонка",
      "pricePaid": 50,
      "weight": 10,
      "cost": 500
    },
    {
      "name": "Северянка",
      "pricePaid": 60,
      "weight": 20,
      "cost": 1200
    }
  ]
}
```

- GET/supply-management/supplies - Получение списка поступлений 

Пример тела ответа:
```json
[
  {
    "name": "Лимонка",
    "pricePaid": 50,
    "weight": 10,
    "cost": 500
  },
  {
    "name": "Северянка",
    "pricePaid": 60,
    "weight": 20,
    "cost": 1200
  }
]
```

В проекте есть миграции с тестовыми данными, поэтому все тела запросов/ответов выше актуальны.

#### Инструкция для тестового запуска

1. Клонирование репозитория
```sh
git clone https://github.com/IValerieI/products-manager.git
cd products-manager
```
2. Сборка и запуск тестовой среды
```sh
docker-compose up -d
```
3. После старта всех контейнеров ознакомиться 
со Swagger можно будет по адресу http://localhost:8080/swagger-ui/index.html
4. Также можно протестировать работу приложения через Postman (примеры запросов были выше)
5. Для остановки работы среды вызвать команду
```sh
docker-compose down -v
```